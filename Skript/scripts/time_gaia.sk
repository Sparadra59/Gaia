#
#
#
# Skript for Gaïa Time
#
#
#
#
# On Logout
#
#
on quit:
	set {last.logout.%player%} to now
on join:
	set {last.logout.mailed.%player%} to 0
#
#
# On Load
#
#
on load:
	set {day.index::*} to contents from url "https://gaia-minecraft.000webhostapp.com/day.php/"
	wait 5 minutes
	loop {email.list::*}:
		if difference between {last.logout.%loop-value%} and now is smaller than 3 days:
			stop
		else:
			if {last.logout.mailed.%loop-value%} is 1:
				stop
			else:
				add 1 to {last.logout.mailed.%loop-value%}
				send email with subject "Bonjour %loop-value% ! Nous avons remarqué que ça fait plus d'un mois que vous ne vous êtes pas connecté ! Revenez nous voir rapidement à l'adresse IP: gaia.craft.gg" with message "Vous manquez à Gaïa !" to "%loop-value%"
		
		if difference between {last.logout.%loop-value%} and now is smaller than 5 days:
			stop
		else:
			if {last.logout.mailed.%loop-value%} is 2:
				stop
			else:
				add 1 to {last.logout.mailed.%loop-value%}
				send email with subject "Bonjour %loop-value% ! Nous avons remarqué que ça fait plus de trois mois que vous ne vous êtes pas connecté ! Revenez nous voir rapidement à l'adresse IP: gaia.craft.gg" with message "Vous manquez à Gaïa !" to "%{email.%loop-value%}%"

#
#
# Restart at 5 o'clock
#
#
every 52 minutes in "Gaia":
	set {hour.system} to "%hour%"

	if {hour.system} is "5":

		if {day.index} is 7:
			loop {place.location.1::*}:
				set block at loop-value to air
			wait 5 ticks
			loop {break.location.1::*}:
				set block at loop-value to {break.type.1::%loop-index%}
			clear {break.location.1::*}
			clear {break.type.1::*}
			clear {place.location.1::*}
			wait 5 ticks
			
		else:
			set {day.index.temp} to {day.index::1} + 1
			loop {place.location.%{day.index.temp}%::*}:
				set block at loop-value to air
			wait 5 ticks
			loop {break.location.%{day.index.temp}%::*}:
				set block at loop-value to {break.type.%{day.index.temp}%::%loop-index%}
			clear {break.location.%{day.index.temp}%::*}
			clear {break.type.%{day.index.temp}%::*}
			clear {place.location.%{day.index.temp}%::*}
			wait 5 ticks
#
# ADD IN SERVER RESTART
#

